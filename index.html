<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>è‹±èªãƒ†ã‚­ã‚¹ãƒˆèª­ã¿ä¸Šã’</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background:#f5f7fb; padding: 24px; }
    .container { max-width: 900px; margin: 0 auto; background:#fff; border-radius: 16px; box-shadow: 0 12px 30px rgba(0,0,0,.08); padding: 28px; }
    h1 { font-size: 1.6rem; margin-bottom: 10px; color:#333; }
    .hint { color:#666; font-size:.9rem; margin-bottom: 16px; }
    label { font-weight: 600; color:#444; display:block; margin-top: 8px; margin-bottom: 6px; }
    textarea {
      width: 100%; min-height: 200px; padding: 12px 14px; border: 2px solid #e6e8ee; border-radius: 12px;
      font: 16px/1.6 "Georgia", serif; resize: vertical; background:#fafbff;
    }
    textarea:focus { outline: none; border-color: #8aa4ff; background:#fff; box-shadow: 0 0 0 3px rgba(138,164,255,.15); }
    .row { display:flex; gap: 12px; align-items: center; flex-wrap: wrap; margin-top: 10px; }
    select, button {
      border-radius: 10px; border: 2px solid #e6e8ee; padding: 8px 12px; background:#fff; font-weight:600;
    }
    select:focus { outline:none; border-color:#8aa4ff; }
    button { cursor: pointer; transition:.2s; }
    button:disabled { opacity:.6; cursor:not-allowed; }
    .play { background:#2ecc71; border-color:#2ecc71; color:#fff; }
    .pause { background:#ffb74d; border-color:#ffb74d; color:#fff; }
    .stop { background:#e74c3c; border-color:#e74c3c; color:#fff; }
    .prev { background:#6c5ce7; border-color:#6c5ce7; color:#fff; }
    .next { background:#00b894; border-color:#00b894; color:#fff; }
    .repeat { background:#ff7675; border-color:#ff7675; color:#fff; }
    .reset { background:#556cd6; border-color:#556cd6; color:#fff; }
    .meta { display:flex; justify-content: space-between; align-items: baseline; flex-wrap: wrap; gap: 8px; }
    .char-counter { color:#666; font-size:.85rem; }
    .estimate { color:#444; font-size:.9rem; font-weight:600; }
    .viewer {
      margin-top: 16px; border: 2px solid #e6e8ee; border-radius: 12px; padding: 14px; background:#fff;
      max-height: 360px; overflow: auto; white-space: pre-wrap;
    }
    .sentence { padding: 2px 3px; border-radius: 4px; }
    .sentence.highlight { background: #ffeb3b; }
    .controls-info { display:flex; justify-content: space-between; align-items:center; margin-top: 12px; }
    .progress-info { color:#444; font-size:.9rem; font-weight:600; }
    .timer { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; font-size: 1.3rem; }
    .footnote { margin-top: 12px; color:#666; font-size:.85rem; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ§ è‹±èªãƒ†ã‚­ã‚¹ãƒˆèª­ã¿ä¸Šã’</h1>
    <p class="hint">æœ€å¤§ <b>10,000æ–‡å­—</b>ã€‚æ–‡ç« å˜ä½ã§èª­ã¿ä¸Šã’ãƒ»ãƒã‚¤ãƒ©ã‚¤ãƒˆã€‚ãƒªãƒ”ãƒ¼ãƒˆæ©Ÿèƒ½ã§ã‚·ãƒ£ãƒ‰ãƒ¼ã‚¤ãƒ³ã‚°ç·´ç¿’å¯¾å¿œã€‚<br>ç›®å®‰ã®æ‰€è¦æ™‚é–“ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¡¨ç¤ºã—ã¾ã™ï¼ˆæ¨å®šï¼‰ã€‚</p>

    <label for="text">ãƒ†ã‚­ã‚¹ãƒˆ</label>
    <textarea id="text" maxlength="10000" placeholder="Enter English text here (up to 10,000 chars)..."></textarea>
    <div class="meta">
      <div class="char-counter" id="counter">0 / 10000</div>
      <div class="estimate" id="estimate">æ‰€è¦æ™‚é–“ã®ç›®å®‰: 00:00</div>
    </div>

    <div class="row">
      <label for="rate">å†ç”Ÿé€Ÿåº¦</label>
      <select id="rate" aria-label="Playback rate">
        <option value="0.5">0.5x</option>
        <option value="0.6">0.6x</option>
        <option value="0.7">0.7x</option>
        <option value="0.8">0.8x</option>
        <option value="0.9">0.9x</option>
        <option value="1" selected>1.0x</option>
        <option value="1.1">1.1x</option>
        <option value="1.2">1.2x</option>
      </select>

      <button id="play" class="play">â–¶ å†ç”Ÿ</button>
      <button id="stop" class="stop" disabled>â¹ åœæ­¢</button>
      <button id="restart" class="reset">â® æœ€åˆã‹ã‚‰</button>
      <button id="previous" class="prev" disabled>âª å‰ã®æ–‡</button>
      <button id="next" class="next" disabled>â© æ¬¡ã®æ–‡</button>
      <button id="repeat" class="repeat" disabled>ğŸ”„ ãƒªãƒ”ãƒ¼ãƒˆ</button>
      <button id="reset" class="reset">ğŸ”„ ãƒªã‚»ãƒƒãƒˆ</button>
    </div>

    <div class="viewer" id="viewer" aria-live="polite"></div>

    <div class="controls-info">
      <div class="progress-info" id="progress">æº–å‚™å®Œäº†</div>
      <div class="timer" id="timer">00:00</div>
    </div>

    <div class="footnote">â€» æ¨å®šæ™‚é–“ã¯ã€Œå˜èªæ•° Ã· (åŸºæº–WPMÃ—å†ç”Ÿé€Ÿåº¦)ã€ã§è¨ˆç®—ã—ã¦ã„ã¾ã™ã€‚åŸºæº–WPMã¯ <b>140</b> ã¨ã—ã¦ãŠã‚Šã€å®Ÿéš›ã®TTSãƒ»æ–‡æ§‹é€ ã«ã‚ˆã‚Šå‰å¾Œã—ã¾ã™ã€‚<br>â€» ãƒ–ãƒ©ã‚¦ã‚¶ã®éŸ³å£°åˆæˆAPIã‚’ä½¿ç”¨ã—ã¾ã™ï¼ˆChrome æ¨å¥¨ï¼‰ã€‚è‹±èªéŸ³å£°ã‚¨ãƒ³ã‚¸ãƒ³ã‚’è‡ªå‹•é¸æŠã—ã¾ã™ã€‚</div>
  </div>

  <script>
    const MAX_LEN = 10000;
    const BASE_WPM = 140;

    const synthesis = window.speechSynthesis;

    const elText = document.getElementById('text');
    const elCounter = document.getElementById('counter');
    const elRate = document.getElementById('rate');
    const elPlay = document.getElementById('play');
    const elStop = document.getElementById('stop');
    const elRestart = document.getElementById('restart');
    const elPrevious = document.getElementById('previous');
    const elNext = document.getElementById('next');
    const elRepeat = document.getElementById('repeat');
    const elReset = document.getElementById('reset');
    const elViewer = document.getElementById('viewer');
    const elProgress = document.getElementById('progress');
    const elTimer = document.getElementById('timer');
    const elEstimate = document.getElementById('estimate');

    // ãƒ—ãƒ­ä»•æ§˜ã®çŠ¶æ…‹ç®¡ç†ï¼ˆã‚¹ãƒãƒ›å¯¾å¿œï¼‰
    let sentences = [];
    let currentIndex = 0;
    let action = 'stopped'; // 'stopped' | 'playing' | 'paused_like' | 'navigating'
    let playId = 0; // ç™ºè©±ã‚»ãƒƒã‚·ãƒ§ãƒ³è­˜åˆ¥å­
    let suppressAdvance = false; // onend ã§ã®æ¬¡é€ã‚Šç¦æ­¢ãƒ–ãƒ¬ãƒ¼ã‚­
    let currentUtterance = null;

    // ã‚¿ã‚¤ãƒãƒ¼é–¢é€£
    let startTime = 0;
    let elapsed = 0;
    let timerHandle = null;

    // é€£æ‰“ãƒ‡ãƒã‚¦ãƒ³ã‚¹
    let clickLock = false;
    function withClickLock(fn) {
      if (clickLock) return;
      clickLock = true;
      try { fn(); } finally {
        setTimeout(() => { clickLock = false; }, 250);
      }
    }

    function startTimer() {
      if (!timerHandle) {
        startTime = Date.now();
        timerHandle = setInterval(() => {
          const t = elapsed + (Date.now() - startTime);
          const m = Math.floor(t / 60000);
          const s = Math.floor((t % 60000) / 1000);
          elTimer.textContent = `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
        }, 100);
      }
    }

    function pauseTimer() {
      if (timerHandle) {
        elapsed += (Date.now() - startTime);
        clearInterval(timerHandle);
        timerHandle = null;
      }
    }

    function resetTimer() {
      if (timerHandle) {
        clearInterval(timerHandle);
        timerHandle = null;
      }
      elapsed = 0;
      elTimer.textContent = '00:00';
    }

    function escapeHTML(str) {
      return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#039;');
    }

    function splitIntoSentences(text) {
      const raw = text.match(/[^.!?\n]+(?:[.!?]+|(?:\n+)|$)/g) || [];
      return raw.map(s => s.trim()).filter(Boolean);
    }

    function renderSentences(list) {
      const html = list.map((s, i) => `<span id="sent-${i}" class="sentence">${escapeHTML(s)}</span> `).join('');
      elViewer.innerHTML = html;
    }

    function updateProgress() {
      if (sentences.length > 0) {
        const progress = `æ–‡ç«  ${currentIndex + 1}/${sentences.length}`;
        let statusInfo = '';
        if (action === 'paused_like') statusInfo = ' (åœæ­¢ä¸­)';
        else if (action === 'playing') statusInfo = ' (å†ç”Ÿä¸­)';
        else if (action === 'repeating') statusInfo = ' (ãƒªãƒ”ãƒ¼ãƒˆä¸­)';
        elProgress.textContent = progress + statusInfo;
      } else {
        elProgress.textContent = 'æº–å‚™å®Œäº†';
      }
    }

    function clearHighlight() {
      document.querySelectorAll('.sentence.highlight').forEach(el => {
        el.classList.remove('highlight');
      });
    }

    function highlightCurrent() {
      clearHighlight();
      const span = document.getElementById(`sent-${currentIndex}`);
      if (span) {
        span.classList.add('highlight');
        span.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    }

    function updateButtons() {
      elPlay.disabled = action === 'playing' || action === 'repeating';
      elStop.disabled = action === 'stopped';
      const canNavigate = sentences.length > 0;
      elPrevious.disabled = !canNavigate || currentIndex === 0;
      elNext.disabled = !canNavigate || currentIndex >= sentences.length - 1;
      elRepeat.disabled = !canNavigate;
    }

    // å …ç‰¢ãªè‹±èªéŸ³å£°é¸æŠï¼ˆé™å¯‚ç‰ˆï¼‰
    function getEnglishVoice() {
      const voices = speechSynthesis.getVoices();
      if (!voices.length) return null;

      // ãƒ–ãƒ©ã‚¦ã‚¶æ—¢å®šãŒè‹±èªãªã‚‰ãã‚Œã§OK
      const def = voices.find(v => v.default && /^en(-|$)/i.test(v.lang));
      if (def) {
        return def;
      }

      // è¨€èªå„ªå…ˆã§è‹±èªéŸ³å£°ã‚’é¸æŠ
      const en = voices.filter(v => /^en(-|$)/i.test(v.lang));
      if (en.length) {
        // å¥³æ€§éŸ³å£°ãŒã‚ã‚Œã°å„ªå…ˆï¼ˆè»½åº¦ã®å„ªå…ˆå‡¦ç†ï¼‰
        const femaleVoice = en.find(v => {
          const name = v.name.toLowerCase();
          return name.includes('female') || name.includes('samantha') || name.includes('victoria') || name.includes('susan');
        });
        
        if (femaleVoice) {
          return femaleVoice;
        }
        
        return en[0];
      }
      
      return null;
    }

    function speakCurrentSentence() {
      if (currentIndex >= sentences.length) {
        // å®Œäº†
        action = 'stopped';
        pauseTimer();
        updateButtons();
        updateProgress();
        clearHighlight();
        return;
      }

      const text = sentences[currentIndex];
      const id = ++playId; // ã‚»ãƒƒã‚·ãƒ§ãƒ³IDç”Ÿæˆ
      
      highlightCurrent();
      updateProgress();

      currentUtterance = new SpeechSynthesisUtterance(text);
      currentUtterance.lang = 'en-US';
      currentUtterance.rate = parseFloat(elRate.value);
      currentUtterance.pitch = 1;
      currentUtterance.volume = 1.0;
      currentUtterance.playId = id; // ã‚»ãƒƒã‚·ãƒ§ãƒ³è­˜åˆ¥ç”¨

      // è‹±èªéŸ³å£°ã®é¸æŠ
      const englishVoice = getEnglishVoice();
      if (englishVoice) {
        currentUtterance.voice = englishVoice;
      }

      // å®Ÿéš›ã«å–‹ã‚Šå§‹ã‚ãŸæ™‚ç‚¹ã§ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹
      currentUtterance.onstart = () => {
        if (action === 'playing') {
          startTimer();
        }
      };

      currentUtterance.onend = () => {
        // ğŸ›¡ï¸ ã‚¹ãƒãƒ›å¯¾å¿œï¼šå¤ã„ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ»æ„å›³ã—ãªã„é€²è¡Œã‚’é˜²ã
        if (currentUtterance.playId !== playId) return;
        if (suppressAdvance) return;
        
        // ãƒªãƒ”ãƒ¼ãƒˆæ™‚ã¯åœæ­¢çŠ¶æ…‹ã«ã—ã¦ã€å‹æ‰‹ã«é€²ã¾ãªã„
        if (action === 'repeating') {
          action = 'paused_like';
          pauseTimer();
          updateButtons();
          updateProgress();
          return;
        }
        
        if (action !== 'playing') return;

        // é€šå¸¸å†ç”Ÿã®ã¿æ¬¡ã¸
        currentIndex++;
        if (currentIndex < sentences.length) {
          setTimeout(() => speakCurrentSentence(), 300); // æ¬¡ã®æ–‡
        } else {
          action = 'stopped';
          pauseTimer();
          updateButtons();
          updateProgress();
          clearHighlight();
        }
      };

      currentUtterance.onerror = () => {
        // ã‚¨ãƒ©ãƒ¼æ™‚ã‚‚åŒã˜ã‚¬ãƒ¼ãƒ‰ã§å®‰å…¨ã«å‡¦ç†
        if (currentUtterance.playId !== playId) return;
        if (suppressAdvance) return;
        
        // ãƒªãƒ”ãƒ¼ãƒˆæ™‚ã¯åœæ­¢çŠ¶æ…‹ã«ã—ã¦ã€å‹æ‰‹ã«é€²ã¾ãªã„
        if (action === 'repeating') {
          action = 'paused_like';
          pauseTimer();
          updateButtons();
          updateProgress();
          return;
        }
        
        if (action !== 'playing') return;
        
        // ã‚¨ãƒ©ãƒ¼æ™‚ã¯æ¬¡ã®æ–‡ã¸
        currentIndex++;
        if (currentIndex < sentences.length) {
          setTimeout(() => speakCurrentSentence(), 300);
        } else {
          action = 'stopped';
          pauseTimer();
          updateButtons();
          updateProgress();
          clearHighlight();
        }
      };

      suppressAdvance = false; // ã“ã®å†ç”Ÿã¯ã€Œé€²ã‚ã‚‹ã€å¯èƒ½æ€§ã‚ã‚Š
      synthesis.speak(currentUtterance);
    }

    // æ¨å®šæ™‚é–“è¨ˆç®—
    function mmss(minutesFloat) {
      const totalSeconds = Math.max(0, Math.round(minutesFloat * 60));
      const m = Math.floor(totalSeconds / 60);
      const s = totalSeconds % 60;
      return `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
    }

    function updateEstimate() {
      const text = elText.value;
      const words = (text.trim().match(/\b[\w'-]+\b/g) || []).length;
      const rate = parseFloat(elRate.value || "1");
      const wpm = BASE_WPM * rate;
      const minutes = words / Math.max(1, wpm);
      elEstimate.textContent = `æ‰€è¦æ™‚é–“ã®ç›®å®‰: ${mmss(minutes)}ï¼ˆç´„ ${words} words, é€Ÿåº¦ ${rate}xï¼‰`;
    }

    // â–¶ å†ç”Ÿï¼šç¾åœ¨ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆæ–‡ã®å…ˆé ­ã‹ã‚‰å†ç”Ÿ
    elPlay.addEventListener('click', () => {
      const raw = elText.value.trim();
      if (!raw) { 
        alert('ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚'); 
        return; 
      }
      
      if (!('speechSynthesis' in window)) { 
        alert('éŸ³å£°åˆæˆæ©Ÿèƒ½ãŒä½¿ãˆã¾ã›ã‚“ã€‚å¯¾å¿œãƒ–ãƒ©ã‚¦ã‚¶ã§ãŠè©¦ã—ãã ã•ã„ã€‚'); 
        return; 
      }

      // æ–°è¦ãƒ†ã‚­ã‚¹ãƒˆã®å ´åˆã¯è§£æ
      if (sentences.length === 0) {
        sentences = splitIntoSentences(raw);
        if (sentences.length === 0) { 
          alert('èª­ã¿ä¸Šã’ã‚‹æ–‡ç« ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚'); 
          return; 
        }
        renderSentences(sentences);
        currentIndex = 0;
        highlightCurrent(); // åˆå›ãƒã‚¤ãƒ©ã‚¤ãƒˆè¡¨ç¤º
      }
      
      // æ—§ç™ºè©±ã‚’å®Œå…¨åœæ­¢ï¼ˆadvanceç¦æ­¢ & IDæ›´æ–°ï¼‰
      suppressAdvance = true;
      playId++;
      synthesis.cancel();

      action = 'playing';
      suppressAdvance = false;
      resetTimer();
      updateButtons();
      speakCurrentSentence(); // currentIndex ã®æ–‡é ­ã‹ã‚‰
    });

    // â¹ åœæ­¢ï¼šç¾åœ¨ã®æ–‡ã§æ­¢ã‚ã‚‹ï¼ˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯ç¶­æŒï¼‰
    elStop.addEventListener('click', () => withClickLock(() => {
      suppressAdvance = true; // onendã§advanceã•ã›ãªã„
      playId++;
      synthesis.cancel();
      action = 'paused_like';
      pauseTimer();
      updateButtons();
      updateProgress();
    }));

    // â® æœ€åˆã‹ã‚‰ï¼šã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’0ã«ã—ã¦å…ˆé ­ã‹ã‚‰å†ç”Ÿæº–å‚™
    elRestart.addEventListener('click', () => withClickLock(() => {
      suppressAdvance = true;
      playId++;
      synthesis.cancel();
      currentIndex = 0;
      action = 'stopped';
      pauseTimer();
      highlightCurrent();
      updateButtons();
      updateProgress();
    }));

    // âª å‰ã®æ–‡ï¼šå†ç”Ÿä¸­ãªã‚‰ç§»å‹•ã—ã¦ç¶™ç¶šã€åœæ­¢ä¸­ãªã‚‰ç§»å‹•ã®ã¿
    elPrevious.addEventListener('click', () => withClickLock(() => {
      if (currentIndex > 0) {
        const wasPlaying = action === 'playing' || action === 'repeating';
        
        suppressAdvance = true;
        playId++;
        synthesis.cancel();
        currentIndex--;
        
        if (wasPlaying) {
          // å†ç”Ÿä¸­ã ã£ãŸå ´åˆã¯ç§»å‹•å…ˆã‹ã‚‰è‡ªå‹•å†ç”Ÿç¶™ç¶š
          action = 'playing';
          updateButtons();
          updateProgress();
          speakCurrentSentence();
        } else {
          // åœæ­¢ä¸­ã ã£ãŸå ´åˆã¯ç§»å‹•ã®ã¿
          action = 'paused_like';
          pauseTimer();
          highlightCurrent();
          updateButtons();
          updateProgress();
        }
      }
    }));

    // â© æ¬¡ã®æ–‡ï¼šå†ç”Ÿä¸­ãªã‚‰ç§»å‹•ã—ã¦ç¶™ç¶šã€åœæ­¢ä¸­ãªã‚‰ç§»å‹•ã®ã¿
    elNext.addEventListener('click', () => withClickLock(() => {
      if (currentIndex < sentences.length - 1) {
        const wasPlaying = action === 'playing' || action === 'repeating';
        
        suppressAdvance = true;
        playId++;
        synthesis.cancel();
        currentIndex++;
        
        if (wasPlaying) {
          // å†ç”Ÿä¸­ã ã£ãŸå ´åˆã¯ç§»å‹•å…ˆã‹ã‚‰è‡ªå‹•å†ç”Ÿç¶™ç¶š
          action = 'playing';
          updateButtons();
          updateProgress();
          speakCurrentSentence();
        } else {
          // åœæ­¢ä¸­ã ã£ãŸå ´åˆã¯ç§»å‹•ã®ã¿
          action = 'paused_like';
          pauseTimer();
          highlightCurrent();
          updateButtons();
          updateProgress();
        }
      }
    }));

    // ğŸ”„ ãƒªãƒ”ãƒ¼ãƒˆï¼šåŒã˜æ–‡ç« ã‚’ã‚‚ã†ä¸€åº¦å†ç”Ÿï¼ˆå®Œäº†å¾Œã¯åœæ­¢çŠ¶æ…‹ï¼‰
    elRepeat.addEventListener('click', () => withClickLock(() => {
      if (sentences.length > 0) {
        suppressAdvance = true;
        playId++;
        synthesis.cancel();
        action = 'repeating'; // ãƒªãƒ”ãƒ¼ãƒˆçŠ¶æ…‹
        updateButtons();
        speakCurrentSentence(); // åŒã˜ index ã‚’èª­ã¿ç›´ã—
      }
    }));

    // ğŸ”„ ãƒªã‚»ãƒƒãƒˆï¼šå®Œå…¨åˆæœŸåŒ–
    elReset.addEventListener('click', () => {
      suppressAdvance = true;
      playId++;
      synthesis.cancel();
      action = 'stopped';
      currentIndex = 0;
      sentences = [];
      elText.value = "";
      elCounter.textContent = `0 / ${MAX_LEN}`;
      elViewer.innerHTML = "";
      resetTimer();
      updateButtons();
      updateProgress();
      updateEstimate();
    });

    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ
    elText.addEventListener('input', () => {
      let val = elText.value;
      if (val.length > MAX_LEN) {
        elText.value = val.slice(0, MAX_LEN);
      }
      const len = elText.value.length;
      elCounter.textContent = `${len} / ${MAX_LEN}`;
      updateEstimate();
    });

    // é€Ÿåº¦å¤‰æ›´æ™‚ã®æ¨å®šæ™‚é–“æ›´æ–°
    elRate.addEventListener('change', () => {
      updateEstimate();
    });

    // éŸ³å£°ãƒªã‚¹ãƒˆåˆæœŸåŒ–ï¼ˆé™å¯‚ç‰ˆï¼‰
    function initializeVoices() {
      // éŸ³å£°ãƒªã‚¹ãƒˆã®èª­ã¿è¾¼ã¿å®Œäº†ã‚’å¾…ã¤ã®ã¿
      // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ãªã—
    }

    // éŸ³å£°ãƒªã‚¹ãƒˆå¤‰æ›´ã‚¤ãƒ™ãƒ³ãƒˆã®ç›£è¦–
    speechSynthesis.addEventListener('voiceschanged', initializeVoices);

    // åˆæœŸåŒ–
    updateButtons();
    updateProgress();
    elCounter.textContent = `0 / ${MAX_LEN}`;
    updateEstimate();
    
    // éŸ³å£°åˆæœŸåŒ–ï¼ˆãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ï¼‰
    setTimeout(initializeVoices, 100);
  </script>
</body>
</html>
